# Analyses Directory Structure

This directory contains all business idea analyses generated by the system. Each idea gets its own subdirectory with a clean, organized file structure.

## Directory Organization

```md
analyses/
├── {idea-slug}/                    # One directory per analyzed idea
│   ├── analysis.md                 # Current/latest analysis (always up-to-date)
│   ├── metadata.json               # Run metadata (timestamps, stats, status)
│   ├── reviewer_feedback.json      # Latest reviewer feedback (if reviewer enabled)
│   ├── iteration_history.json      # Complete iteration history (if reviewer enabled)
│   ├── iterations/                 # Current run's iteration files
│   │   ├── iteration_1.md          # First iteration analysis
│   │   ├── iteration_2.md          # Second iteration (if needed)
│   │   ├── feedback_1.json         # Feedback for iteration 1
│   │   └── feedback_2.json         # Feedback for iteration 2
│   └── .archive/                   # Hidden archive of previous runs
│       ├── migrated_old_files/     # Old timestamped files (pre-cleanup)
│       ├── test_001_YYYYMMDD/      # Archived test runs (numbered)
│       └── production_001_YYYYMMDD/ # Archived production runs
└── README.md                       # This file
```

## Key Files

### `analysis.md`

The current, complete analysis of the business idea. This is a real file (not a symlink) that gets updated with each run. Always contains the most recent analysis.

### `metadata.json`

Contains metadata about the current analysis:

- Creation timestamp
- Final status (completed, accepted, max_iterations_reached)
- Word and character counts
- Reviewer decision and assessment (if applicable)
- Iteration count and details

### `reviewer_feedback.json`

Present when the reviewer is enabled (`--with-review` flag). Contains the latest feedback with:

- Overall assessment
- Critical issues that must be addressed
- Suggested improvements
- Accept/reject decision
- Detailed reasoning

### `iteration_history.json`

Complete history of all iterations in the current run, including:

- All iteration files and their locations
- Feedback for each iteration
- Accept/reject decisions at each step
- Final status

### `iterations/`

Contains the individual files from the current run:

- `iteration_N.md`: Analysis at iteration N
- `feedback_N.json`: Reviewer feedback for iteration N

## Archive System

### Automatic Archiving

When you run a new analysis for an existing idea, the system automatically:

1. Archives the current files to `.archive/` before starting
2. Creates numbered archive directories (e.g., `test_001_20250815`)
3. Keeps test and production runs separate
4. Maintains only the 5 most recent archives of each type

### Archive Structure

```md
.archive/
├── migrated_old_files/        # One-time migration of old timestamped files
│   ├── analysis_20250815_104944.md
│   └── ...
├── test_001_20250815_104500/  # Test run archives (when --debug used)
│   ├── analysis.md
│   ├── metadata.json
│   └── iterations/
└── production_001_20250815/    # Production run archives
    └── ... (same structure)
```

### Migration from Old Structure

If you have old timestamped files (e.g., `analysis_20250815_104944.md`), they'll be automatically migrated to `.archive/migrated_old_files/` on the first run of the new system.

## Workflow Examples

### Simple Analysis (No Reviewer)

```bash
python src/cli.py "AI fitness app for seniors"
```

Creates:

- `analyses/ai-fitness-app-for-seniors/analysis.md`
- `analyses/ai-fitness-app-for-seniors/metadata.json`

### Analysis with Reviewer

```bash
python src/cli.py "B2B marketplace" --with-review --max-iterations 2
```

Creates:

- All files from simple analysis, plus:
- `reviewer_feedback.json` with final feedback
- `iteration_history.json` with complete history
- `iterations/` directory with iteration files

### Re-running an Analysis

When you run the same idea again:

1. Current files are archived to `.archive/test_002_YYYYMMDD/`
2. New analysis overwrites the main files
3. Old runs remain accessible in archives

## Best Practices

1. **Check Current Analysis**: Always look at `analysis.md` for the latest version
2. **Review Metadata**: Check `metadata.json` for quality metrics and status
3. **Examine Feedback**: If reviewer was used, check `reviewer_feedback.json` for improvement areas
4. **Access History**: Use `.archive/` to compare with previous runs
5. **Clean Up**: The system auto-manages archives, keeping only recent runs

## Troubleshooting

### Missing Files

If expected files are missing:

- Check if they were migrated to `.archive/migrated_old_files/`
- Look in `.archive/` for previous run archives
- Ensure the analysis completed successfully (check logs)

### File Clutter

If you see many timestamped files:

- Run any new analysis to trigger automatic migration
- Old files will be moved to `.archive/migrated_old_files/`
- The directory will be cleaned up automatically

### Finding Old Analyses

To access previous versions:

1. Navigate to `.archive/` in the idea directory
2. Check numbered directories by date
3. `test_` prefix = debug runs, `production_` = normal runs

## Notes

- The `.archive/` directory is hidden (starts with dot) to reduce clutter
- Archive limit is configurable (default: 5 per type)
- Test runs (with `--debug`) are archived separately from production runs
- All timestamps are in YYYYMMDD_HHMMSS format (local time)
